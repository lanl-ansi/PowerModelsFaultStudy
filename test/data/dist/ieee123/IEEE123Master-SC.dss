Clear


New object=circuit.ieee123
!~ basekv=4.16 Bus1=150 pu=1.00 R1=0 X1=0.0001 R0=0 X0=0.0001
!~ basekv=66.00 bus1=SourceBus pu=1.02 R1=0.6 X1=3.0 R0=0.3 X0=5.0 !Based on Diamond
~ basekv=66.00 bus1=SourceBus pu=1.02 R1=4 X1=15 R0=13 X0=40 !Based on Toquerville

New Transformer.Sub phases=3  windings=2  buses=(SourceBus, 150)  conns=(delta wye)  sub=y
~ kvs=(66, 4.16)  kvas=(10000 10000)  xhl=7.6  sub=y wdg=1  %r=.35 wdg=2  %r=.35


new transformer.reg1a phases=3 windings=2 buses=[150 150r] conns=[wye wye] kvs=[4.16 4.16] kvas=[5000 5000] XHL=.001 %LoadLoss=0.00001 ppm=0.0
new regcontrol.creg1a transformer=reg1a winding=2 vreg=120 band=2 ptratio=20 ctprim=700 R=3 X=7.5

Redirect        IEEELinecodes.DSS
Redirect        IEEE123Lines.dss


! NORMALLY CLOSED SWITCHES ARE DEFINED AS SHORT LINES
! Could also be defned by setting the Switch=Yes property

New Line.Sw1    phases=3  Bus1=150r   Bus2=149    r1=1e-3 r0=1e-3 x1=0.000 x0=0.000 c1=0.000 c0=0.000 Length=0.001
New Line.Sw2    phases=3  Bus1=13     Bus2=152    r1=1e-3 r0=1e-3 x1=0.000 x0=0.000 c1=0.000 c0=0.000 Length=0.001
New Line.Sw3    phases=3  Bus1=18     Bus2=135    r1=1e-3 r0=1e-3 x1=0.000 x0=0.000 c1=0.000 c0=0.000 Length=0.001
New Line.Sw4    phases=3  Bus1=60     Bus2=160    r1=1e-3 r0=1e-3 x1=0.000 x0=0.000 c1=0.000 c0=0.000 Length=0.001
New Line.Sw5    phases=3  Bus1=97     Bus2=197    r1=1e-3 r0=1e-3 x1=0.000 x0=0.000 c1=0.000 c0=0.000 Length=0.001
New Line.Sw6    phases=3  Bus1=61     Bus2=61s    r1=1e-3 r0=1e-3 x1=0.000 x0=0.000 c1=0.000 c0=0.000 Length=0.001
New Line.Sw7    phases=3  Bus1=151    Bus2=300   r1=1e-3 r0=1e-3  x1=0.000 x0=0.000 c1=0.000 c0=0.000 Length=0.001

! Configuration 1
!Edit line.sw3 enabled=false

! Configuration 2
!Edit line.Sw7 enabled=false

! Configuration 3
!Edit line.sw4 enabled=false

! Configuration 4
!Edit line.sw2 enabled=false

! LOAD TRANSFORMER AT 61s/610
! This is a 150 kVA Delta-Delta stepdown from 4160V to 480V.

New Transformer.XFM1  Phases=3   Windings=2 Xhl=2.72
~ wdg=1 bus=61s       conn=delta kV=4.16    kva=150    %r=0.635
~ wdg=2 bus=610       conn=Delta kv=0.48    kva=150    %r=0.635

! CAPACITORS
Redirect IEEE123Capacitors.dss


!REGULATORS - REDIRECT TO DEFINITIONS FILE
Redirect IEEE123Regulators.DSS

! SPOT LOADS -- REDIRECT INPUT STREAM TO LOAD DEFINITIONS FILE
Redirect IEEE123Loads.DSS

Set VoltageBases = [4.16, 0.48]    ! ARRAY OF VOLTAGES IN KV
CalcVoltageBases  ! PERFORMS ZERO LOAD POWER FLOW TO ESTIMATE VOLTAGE BASES

Redirect IEEE123RegControls.dss

! The default maximum control iterations is 10. With so many regulators each moving only one tap at a time,
! this is insufficient for the 123-bus test case, which will need 15 control iterations for the initial solution.
! Therefore, the 'MaxControlIter' option is set to 30 to be safe.

Set MaxControlIter=30

! Solve executes the solution for the present solution mode, which is "snapshot".

New EnergyMeter.Feeder Line.sw1 1


Buscoords Buscoords.dat   ! load in bus coordinates

Redirect IEEE123Relays.dss
!Redirect IEEE123PV.dss

Solve
